# HitszEpidemicSubmitter

疫情上报每天都要搞，虽然让人很不爽，但毕竟疫情嘛，站在校方立场上又确实马虎不得。不过对于每天在学校里屁事没有的孩子而言又略显麻烦，所以我写了个这玩意儿。

>  **上次更新：2021年10月29日**
>
> - 增加了对新学工系统的支持。
>
> - 对更新后的统一身份认证做了更新。（只更新在了211029脚本中，210118脚本并未更新）

## 环境配置

脚本运行需要Python3.6及以上的环境，此外对于Windows用户，还要安装`requests`包：

```bash
python3 -m pip install requests
```
（或者适用于你电脑配置的其他指令）

## 运行前的准备

运行前，需要在脚本内填写教职工号/学号以及统一身份认证密码，同时也别忘了修改下面的上报信息（相关信息都已详细注释）。

具体来说有这些：

- 第13、14行的账号密码
  
  记得以如下格式填写正确的学号和密码。如果漏填或误填，上报将失败。
  ```python
  login_param = {
    'username': '180310101',  # 学号
    'password': 'ThisIsYourPassword,Daze~',  # 校园认证密码
    # ...
  }
  ```
- 第26行到第138行的上报信息
  
  其中已经填好默认值，如果有需要更改的信息，请参照其上方注释来填写。比如，如果你想修改48小时核酸状况为“已做”，需要更改129行为`"kzl31":"1",`。

## 自动上报

如果想实现每日自动上报，对于Linux用户，直接上`cron`即可；对于Windows用户，可以[设置任务计划](https://jingyan.baidu.com/article/9080802200cc15fd91c80fcf.html)来实现自动化。~~如果保证不了实时开机的话，可以在校园网内通过我的[服务器](http://10.249.77.65/app/epidemic)来自动执行，但要提供你的学号密码哦~~ （树莓派服务器正在降温中，暂时用不了呜呜呜）

## 注意事项

- 学校的统一身份认证登陆在HTTPS下明文传输密码。虽然有一层协议，但仍需注意所处网络环境。
- 更新后的学工系统对一些请求参数的限制更加苛刻，亦不排除今后再有相关的更新。如果脚本出现了报错，请发Issue，我会尽量帮助解决问题或发更新或debug。
- 新的上报系统在提交前会通过AMAP的API获取当前的GPS位置、并得到对应地名。脚本中并未实际实现这一功能 ~~（如果实现了，这算不算偷学校的API Token私用呵呵）~~ ，而是取了风洞实验室附近的某个地点加上正态分布噪声融合成的一个数据。虽然不会有太大偏差，但求稳的话，可以将其改为定值。若不在学校，使用脚本时记得将所在位置经纬度和地理名称改为自己实际位置（经纬度可以从手机指南针应用获取，地理位置映射可以试试[这个](https://map.yanue.net/)）。
- 从2022/2/22起的疫情上报，由于repo主测试时卡在了获取经纬度这一栏（老家的网络和GPS信号有点辣鸡），导致还没测试，所以暂不确定能否正常上报。不过应该没有太大变化。

## 最后

**如果你的身体真的有不良状况，请停止脚本运行并通过正规途径如实上报～（求生欲**
